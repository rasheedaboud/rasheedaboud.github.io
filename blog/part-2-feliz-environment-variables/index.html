<!DOCTYPE html>
    <html data-theme="light" lang="en">
      <head>
        <link rel="stylesheet" type="text/css" href="/assets/static/onRenderClient.98w-kfLM.css">
        <meta charset="UTF-8" />
        <meta name="google-site-verification" content="tasigl22802n6H-QTcOM1o96ZEKow4vzIU36DCZwO4g" />
        <meta http-equiv='cache-control' content='no-cache'> 
        <meta http-equiv='expires' content='0'> 
        <meta http-equiv='pragma' content='no-cache'>
        <link rel="icon" href="/assets/static/favicon.D7K9RfVp.ico" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="In Part Two of our blog series, I showed you how to use environment variables and F# conditional compilation in Vite and Feliz-based F# web apps for safer configuration and behavior adjustments across different environments. Stay tuned for integrating Daisy UI in the next installment!" />
        <title>Part 2-Feliz Environment Variables</title>
      </head>
      <body>
        <div id="react-root"><main class="min-h-screen"><header><nav class="bg-black"><div class="mx-auto max-w-7xl px-2 sm:px-6 lg:px-1"><div class="relative flex h-16 items-center justify-between"><div class="absolute inset-y-0 left-0 flex items-center sm:hidden"><button type="button" class="relative inline-flex items-center justify-center rounded-md p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white" aria-controls="mobile-menu" aria-expanded="false"><span class="absolute -inset-0.5"></span><span class="sr-only">Open main menu</span><svg class="block h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path></svg></button></div><div class="flex flex-1 items-center justify-end sm:items-stretch sm:justify-start"><div class="hidden sm:flex flex-shrink-0 items-center"><svg class="me-auto" width="50" height="50" viewBox="-20 -20 100 100"><g id="SvgjsG1201" transform="scale(1.0)" fill="#fff"><path xmlns="http://www.w3.org/2000/svg" d="M2.61,37.02a1.45852,1.45852,0,0,1-.11-.55V4A1.498,1.498,0,0,1,4,2.5H15.77a1.50728,1.50728,0,0,1,1.06.44L27.18,13.29a1.49682,1.49682,0,0,1,0,2.12L5.06,37.53A1.50653,1.50653,0,0,1,2.61,37.02Z"></path><path xmlns="http://www.w3.org/2000/svg" d="M61.5,4V15.77a1.809,1.809,0,0,1-.11.57,1.62577,1.62577,0,0,1-.33.49L50.71,27.18a1.50713,1.50713,0,0,1-2.12,0L26.47,5.06a1.5155,1.5155,0,0,1,.4901-2.45,1.79313,1.79313,0,0,1,.57-.11L60,2.5A1.498,1.498,0,0,1,61.5,4Z"></path><path xmlns="http://www.w3.org/2000/svg" d="M61.39,26.98a1.45841,1.45841,0,0,1,.11.55V60A1.498,1.498,0,0,1,60,61.5H48.23a1.50747,1.50747,0,0,1-1.06-.44L36.82,50.71a1.49678,1.49678,0,0,1,0-2.12L58.94,26.47A1.50658,1.50658,0,0,1,61.39,26.98Z"></path><path xmlns="http://www.w3.org/2000/svg" d="M19.17,30.94,30.94,19.17a1.509,1.509,0,0,1,2.12,0L44.83,30.94a1.50907,1.50907,0,0,1,0,2.12L33.06,44.83a1.51876,1.51876,0,0,1-2.12,0L19.17,33.06A1.50906,1.50906,0,0,1,19.17,30.94Z"></path><path xmlns="http://www.w3.org/2000/svg" d="M37.86,59.45a1.50661,1.50661,0,0,1-1.39,2.05L4,61.5A1.498,1.498,0,0,1,2.5,60V48.23a1.81029,1.81029,0,0,1,.11-.57,1.62669,1.62669,0,0,1,.33-.49L13.29,36.82a1.54761,1.54761,0,0,1,2.12,0L37.53,58.94A1.28931,1.28931,0,0,1,37.86,59.45Z"></path></g></svg></div><div class="sm:ml-6 sm:block"><div class="flex space-x-4"><a href="/" class="text-gray-300 hover:bg-gray-700 hover:text-white rounded-md px-1 py-3 text-lg font-black" aria-current="page">Rasheed Aboud</a></div></div></div><div class="hidden  sm:flex absolute inset-y-0 right-0  items-center pr-2 sm:static sm:inset-auto sm:ml-6 sm:pr-0"><a href="/blogs" class="text-gray-300 hover:bg-gray-700 hover:text-white rounded-md px-3 py-2 text-sm font-black">Blog</a><a href="/about" class="text-gray-300 hover:bg-gray-700 hover:text-white rounded-md px-3 py-2 text-sm font-black">About</a><a href="/contact" class="text-gray-300 hover:bg-gray-700 hover:text-white rounded-md px-3 py-2 text-sm font-black">Contact</a></div></div></div></nav></header><div class="container mx-auto px-4 py-1"><div><div class="min-h-svh sm:px-10 md:px-24 lg:px-48"><article><div style="min-width:100% !important" class="prose"><h1 class="text-2xl font-black text-pretty uppercase my-5 text-center">Part 2-Feliz Environment Variables</h1><div class="grid-rows-3 grid-flow-col"><div class="flex justify-center items-center"> <figure class="max-w-xs px-3 py-2 min-w-xs "><img style="max-width:300px;max-height:300px" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/66/F_Sharp_logo.svg/1200px-F_Sharp_logo.svg.png" alt="Movie"/></figure></div><div class="grid grid-rows-4 grid-flow-col gap-0 align-middle items-center sm:px-10"><div class="avatar placeholder row-span-4 mx-auto"><div class="bg-neutral text-neutral-content rounded-full w-24"><span class="text-3xl">RA</span></div></div><div class="font-bold uppercase mx-5 sm:mx-0">Rasheed Aboud</div><div class="uppercase mx-5 lg:mx-0">5 min<!-- --> read</div><div class="uppercase mx-5 lg:mx-0">2024-1-2</div><div class="hidden md:block mx-5 lg:mx-0"><button class="badge badge-primary badge-lg mx-1 text-sm sm:text-base">F#</button><button class="badge badge-primary badge-lg mx-1 text-sm sm:text-base">react</button><button class="badge badge-primary badge-lg mx-1 text-sm sm:text-base">fable</button><button class="badge badge-primary badge-lg mx-1 text-sm sm:text-base">feliz</button><button class="badge badge-primary badge-lg mx-1 text-sm sm:text-base">web development</button></div></div></div><h2>TL;DR</h2>
<p>In Part 2 of the F# web development series with Vite and Feliz, we learn how to manage environment variables in F# applications for different environments like development, testing, and production. We discuss storing sensitive data outside the code, accessing it in a type-safe manner through .env files, and conditional compilation using F# #if/#else directives. The post provides code snippets for setting up environment variables and using compiler directives to alter app behavior conditionally. This enhances app flexibility, security, and configurability. Stay tuned for the next part, which will focus on integrating Daisy UI for better UI components.</p>
<h2>Background</h2>
<p>Welcome back to the second part of our blog series on F# web development with Vite and Feliz. In the previous post, we set up our development environment and built a basic web application. Now, we will dive into the topic of environment variables and how they can change how our app&#x27;s behave in different environments.</p>
<p>For the record you should <strong>NEVER</strong> expose any sensitive information in a client application like a web browser! They are inherently not secure. Using environment variables in client to test or change application behavior that does not leak sensitive information is an acceptable use case.</p>
<p>By using environment variables, we can easily configure our app&#x27;s behavior in different environments without hardcoding values. This allows for greater flexibility and control of how are application behave.</p>
<p>We will start by learning how to read environment variables in our F# code using the Vite build tool. Then, we will see how to store variables in .env files and access them in a type-safe manner. Additionally, we will explore the concept of F# conditional compilation and its role in controlling the behavior of our app based on different environments.</p>
<p>By the end of this post, you will have a solid understanding of how to leverage environment variables and conditional compilation in your F# web applications, bringing greater flexibility, security, and configurability to your projects.</p>
<p>Let&#x27;s dive in!</p>
<h2>Prerequisites</h2>
<p>Grab the code form <a href="https://github.com/rasheedaboud/FSharp-Web-Development/tree/main/Part%201%20-Getting%20Started">Part 1</a>. It should contain all the required bits to get going.</p>
<p>Here is a short list of the requirements to run the app:</p>
<ul>
<li>.Net 8</li>
<li>Node ^18</li>
<li>npm | pnpm | yarn</li>
<li><a href="https://code.visualstudio.com/">Visual Studio Code</a> with <a href="http://ionide.io/">Ionide</a></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=alfonsogarciacaro.vscode-template-fsharp-highlight">Highlight templates in F#</a></li>
</ul>
<h2>Getting Started</h2>
<p>First thing were going to do is introduce environment variables. Were going to need them eventually. You can read about how vite deals with .env files and variables <a href="https://vitejs.dev/guide/env-and-mode.html">here</a>. The short and sweet of it is you can add a <code node="[object Object]">.env</code> file to your repo, and add any &#x27;config&#x27; values that you may want to use during testing or development.</p>
<p>By placing any the following files in the <strong>src</strong> folder;</p>
<ul>
<li><code node="[object Object]">.env</code></li>
<li><code node="[object Object]">.env.local</code></li>
<li><code node="[object Object]">.env.production</code></li>
</ul>
<p>You can control what get checked into source control and change how you app behaves in different environments. Although when you publish your app there are better / more secure ways of storing real secrets!</p>
<p>First things first we need a way to read the values we store in the <code node="[object Object]">.env</code> files.</p>
<p>In JavaScript we could just do the following:</p>
<pre class="mb-3 relative box-shadow shadow-2xl"><div class="absolute -top-1  right-7 h-10 w-10 m-5"><button class="btn btn-xs btn-active"><span class=""><i class="fa-solid fa-copy"> <!-- -->Copy</i></span></button></div><div style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-js" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#c586c0">import</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">meta</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">env</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#9cdcfe">VITE_SOME_KEY</span></code></div></pre>
<p>In F# just like in typescript if we want to access these environment variables in a type safe manner there is a bit of setup. I guarantee there is a much nicer / more elegant way of doing this but i find it works well for me.</p>
<p>In  <code node="[object Object]">/src</code> directory create a new F# file, I call mine <code node="[object Object]">Env.fs</code> and add the following code:</p>
<pre class="mb-3 relative box-shadow shadow-2xl"><div class="absolute -top-1  right-7 h-10 w-10 m-5"><button class="btn btn-xs btn-active"><span class=""><i class="fa-solid fa-copy"> <!-- -->Copy</i></span></button></div><div style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-fsharp" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token annotation" style="color:#d4d4d4">[&lt;</span><span class="token annotation" style="color:#4ec9b0">RequireQualifiedAccess</span><span class="token annotation" style="color:#d4d4d4">&gt;]</span><span>
</span><span></span><span class="token" style="color:#569CD6">module</span><span> Env
</span>
<span>    </span><span class="token" style="color:#569CD6">open</span><span> Fable</span><span class="token" style="color:#d4d4d4">.</span><span>Core
</span>
<span>    </span><span class="token annotation" style="color:#d4d4d4">[&lt;</span><span class="token annotation" style="color:#4ec9b0">Emit</span><span class="token annotation annotation-content" style="color:#d4d4d4">(</span><span class="token annotation annotation-content" style="color:#ce9178">&quot;import.meta.env.VITE_KEY&quot;</span><span class="token annotation annotation-content" style="color:#d4d4d4">)</span><span class="token annotation" style="color:#d4d4d4">&gt;]</span><span>
</span><span>    </span><span class="token" style="color:#569CD6">let</span><span> vite_key</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#4ec9b0">string</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> jsNative</span></code></div></pre>
<p>Next add the following to a file called <code node="[object Object]">.env</code> located in the <code node="[object Object]">./src</code> folder:</p>
<pre class="mb-3 relative box-shadow shadow-2xl"><div class="absolute -top-1  right-7 h-10 w-10 m-5"><button class="btn btn-xs btn-active"><span class=""><i class="fa-solid fa-copy"> <!-- -->Copy</i></span></button></div><div style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-env" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>VITE_KEY=&quot;SOME VALUE&quot;</span></code></div></pre>
<p>Similar to setting up a typescript definition file for your vite variables this will now give you access to the value of a variable called &#x27;VITE_KEY&#x27;.</p>
<p>You can test this by printing the value to the console.</p>
<p><code node="[object Object]">Main.fs</code></p>
<pre class="mb-3 relative box-shadow shadow-2xl"><div class="absolute -top-1  right-7 h-10 w-10 m-5"><button class="btn btn-xs btn-active"><span class=""><i class="fa-solid fa-copy"> <!-- -->Copy</i></span></button></div><div style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-fsharp" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#569CD6">module</span><span> Main
</span>
<span></span><span class="token" style="color:#569CD6">open</span><span> Feliz
</span><span></span><span class="token" style="color:#569CD6">open</span><span> App
</span><span></span><span class="token" style="color:#569CD6">open</span><span> Browser</span><span class="token" style="color:#d4d4d4">.</span><span>Dom
</span>
<span>console</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>Env</span><span class="token" style="color:#d4d4d4">.</span><span>vite_key</span><span class="token" style="color:#d4d4d4">)</span><span>
</span>
<span></span><span class="token" style="color:#569CD6">let</span><span> root </span><span class="token" style="color:#d4d4d4">=</span><span> ReactDOM</span><span class="token" style="color:#d4d4d4">.</span><span>createRoot </span><span class="token" style="color:#d4d4d4">(</span><span>document</span><span class="token" style="color:#d4d4d4">.</span><span>getElementById </span><span class="token" style="color:#ce9178">&quot;feliz-app&quot;</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>root</span><span class="token" style="color:#d4d4d4">.</span><span>render </span><span class="token" style="color:#d4d4d4">(</span><span>Components</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#dcdcaa">Counter</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span></code></div></pre>
<p>Which should output <code node="[object Object]">SOME VALUE</code> to the dev console in your browser.</p>
<p>If you want some extra type safety you could do the following back in the <code node="[object Object]">Env.fs</code> file.</p>
<pre class="mb-3 relative box-shadow shadow-2xl"><div class="absolute -top-1  right-7 h-10 w-10 m-5"><button class="btn btn-xs btn-active"><span class=""><i class="fa-solid fa-copy"> <!-- -->Copy</i></span></button></div><div style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-fsharp" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token annotation" style="color:#d4d4d4">[&lt;</span><span class="token annotation" style="color:#4ec9b0">RequireQualifiedAccess</span><span class="token annotation" style="color:#d4d4d4">&gt;]</span><span>
</span><span></span><span class="token" style="color:#569CD6">module</span><span> Env
</span>
<span></span><span class="token" style="color:#569CD6">open</span><span> Fable</span><span class="token" style="color:#d4d4d4">.</span><span>Core
</span>
<span></span><span class="token annotation" style="color:#d4d4d4">[&lt;</span><span class="token annotation" style="color:#4ec9b0">RequireQualifiedAccess</span><span class="token annotation" style="color:#d4d4d4">&gt;]</span><span>
</span><span></span><span class="token" style="color:#569CD6">module</span><span> ViteKey </span><span class="token" style="color:#d4d4d4">=</span><span>
</span>
<span>    </span><span class="token annotation" style="color:#d4d4d4">[&lt;</span><span class="token annotation" style="color:#4ec9b0">Literal</span><span class="token annotation" style="color:#d4d4d4">&gt;]</span><span>
</span><span>    </span><span class="token" style="color:#569CD6">let</span><span> </span><span class="token" style="color:#569CD6">private</span><span> key </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#ce9178">&quot;import.meta.env.VITE_KEY&quot;</span><span>
</span>
<span>    </span><span class="token annotation" style="color:#d4d4d4">[&lt;</span><span class="token annotation" style="color:#4ec9b0">Emit</span><span class="token annotation annotation-content" style="color:#d4d4d4">(</span><span class="token annotation annotation-content">key</span><span class="token annotation annotation-content" style="color:#d4d4d4">)</span><span class="token annotation" style="color:#d4d4d4">&gt;]</span><span>
</span><span>    </span><span class="token" style="color:#569CD6">let</span><span> </span><span class="token" style="color:#569CD6">private</span><span> vite_key_maybe</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#4ec9b0">string</span><span> option </span><span class="token" style="color:#d4d4d4">=</span><span> jsNative
</span>
<span>    </span><span class="token" style="color:#569CD6">let</span><span> value </span><span class="token" style="color:#d4d4d4">=</span><span>
</span><span>        </span><span class="token" style="color:#569CD6">match</span><span> vite_key_maybe </span><span class="token" style="color:#569CD6">with</span><span>
</span><span>        </span><span class="token" style="color:#d4d4d4">|</span><span> Some envValue </span><span class="token" style="color:#d4d4d4">-&gt;</span><span> envValue
</span><span>        </span><span class="token" style="color:#d4d4d4">|</span><span> None </span><span class="token" style="color:#d4d4d4">-&gt;</span><span> failwith $</span><span class="token" style="color:#ce9178">&quot;no env variable with name:{key}  found.&quot;</span></code></div></pre>
<pre class="mb-3 relative box-shadow shadow-2xl"><div class="absolute -top-1  right-7 h-10 w-10 m-5"><button class="btn btn-xs btn-active"><span class=""><i class="fa-solid fa-copy"> <!-- -->Copy</i></span></button></div><div style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-fsharp" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#569CD6">module</span><span> Main
</span>
<span></span><span class="token" style="color:#569CD6">open</span><span> Feliz
</span><span></span><span class="token" style="color:#569CD6">open</span><span> App
</span><span></span><span class="token" style="color:#569CD6">open</span><span> Browser</span><span class="token" style="color:#d4d4d4">.</span><span>Dom
</span><span></span><span class="token" style="color:#569CD6">open</span><span> Fable</span><span class="token" style="color:#d4d4d4">.</span><span>Core</span><span class="token" style="color:#d4d4d4">.</span><span>JsInterop
</span>
<span>console</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>Env</span><span class="token" style="color:#d4d4d4">.</span><span>ViteKey</span><span class="token" style="color:#d4d4d4">.</span><span>value</span><span class="token" style="color:#d4d4d4">)</span><span>
</span>
<span></span><span class="token" style="color:#569CD6">let</span><span> root </span><span class="token" style="color:#d4d4d4">=</span><span> ReactDOM</span><span class="token" style="color:#d4d4d4">.</span><span>createRoot </span><span class="token" style="color:#d4d4d4">(</span><span>document</span><span class="token" style="color:#d4d4d4">.</span><span>getElementById </span><span class="token" style="color:#ce9178">&quot;feliz-app&quot;</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>root</span><span class="token" style="color:#d4d4d4">.</span><span>render </span><span class="token" style="color:#d4d4d4">(</span><span>Components</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#dcdcaa">Home</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span></code></div></pre>
<p>Instead of throwing an error you could also return whatever you want.</p>
<p>If you&#x27;re curious about the weird <code node="[object Object]">[&lt;Emit(&quot;import.meta.env.VITE_KEY&quot;)&gt;]</code> syntax. This a way to call arbitrary javascript methods from F#. Zaid made an excellent post about it back in 2017 that you can <a href="https://medium.com/@zaid.naom/f-interop-with-javascript-in-fable-the-complete-guide-ccc5b896a59f">here</a>. Dont worry too much we&#x27;ll dig a little deeper into Javascript interop later on.</p>
<h2>F# Conditional Compilation</h2>
<p>Another way of conditionally changing how you app behaves is using F# conditional compilation <code node="[object Object]">#if #else</code> blocks in your source code. You can learn all about <a href="https://learn.microsoft.com/en-us/dotnet/fsharp/language-reference/compiler-directives">compiler directives</a> from the microsoft docs.</p>
<p>Alfonso Garcia wrote an excellent blog post about how this topic called &#x27;<a href="https://fable.io/blog/2022/2022-10-26-hot-reload.html">When Fable and F# bring you better tooling than JS</a>&#x27;. He gives some great examples of how using F# and .Net can actually give you a better dev experience than the native tooling available in the javascript ecosystem.</p>
<p>Here is a contrived example of how this would look:</p>
<pre class="mb-3 relative box-shadow shadow-2xl"><div class="absolute -top-1  right-7 h-10 w-10 m-5"><button class="btn btn-xs btn-active"><span class=""><i class="fa-solid fa-copy"> <!-- -->Copy</i></span></button></div><div style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e"><code class="language-fsharp" style="color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#569CD6">module</span><span> Main
</span>
<span></span><span class="token" style="color:#569CD6">open</span><span> Feliz
</span><span></span><span class="token" style="color:#569CD6">open</span><span> App
</span><span></span><span class="token" style="color:#569CD6">open</span><span> Browser</span><span class="token" style="color:#d4d4d4">.</span><span>Dom
</span>
<span></span><span class="token preprocessor" style="color:#9cdcfe">#</span><span class="token preprocessor directive" style="color:#569CD6">if</span><span class="token preprocessor" style="color:#9cdcfe"> DEBUG</span><span>
</span><span>console</span><span class="token" style="color:#d4d4d4">.</span><span>log </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;This will only print if environment is set to debug&quot;</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span></span><span class="token preprocessor" style="color:#9cdcfe">#</span><span class="token preprocessor directive" style="color:#569CD6">endif</span><span>
</span>
<span>console</span><span class="token" style="color:#d4d4d4">.</span><span>log </span><span class="token" style="color:#d4d4d4">(</span><span>Env</span><span class="token" style="color:#d4d4d4">.</span><span>ViteKey</span><span class="token" style="color:#d4d4d4">.</span><span>value</span><span class="token" style="color:#d4d4d4">)</span><span>
</span>
<span></span><span class="token" style="color:#569CD6">let</span><span> root </span><span class="token" style="color:#d4d4d4">=</span><span> ReactDOM</span><span class="token" style="color:#d4d4d4">.</span><span>createRoot </span><span class="token" style="color:#d4d4d4">(</span><span>document</span><span class="token" style="color:#d4d4d4">.</span><span>getElementById </span><span class="token" style="color:#ce9178">&quot;feliz-app&quot;</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>root</span><span class="token" style="color:#d4d4d4">.</span><span>render </span><span class="token" style="color:#d4d4d4">(</span><span>Components</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#dcdcaa">Counter</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></code></div></pre>
<h2>Summary</h2>
<p>In this blog post, we explored how to use environment variables in our F# web application built with Vite and Feliz. We learned how to access environment variables defined in the .env files and store them in F# modules for type-safe access. We also looked at using F# conditional compilation to conditionally change the behavior of our app based on different environments.</p>
<p>By using environment variables, we can easily configure our app&#x27;s behavior in different environments without hardcoding values. This allows for greater flexibility and control of how are application behave.</p>
<p>Overall, leveraging environment variables in our F# web application helps us build more configurable apps with a smoother development experience.</p>
<p>Stay tuned for Part 3 of this blog series, where we will explore how to integrate <a href="https://daisyui.com/docs/install/">Daisy UI</a> into our F# web application. Daisy UI is a powerful UI library that provides ready-to-use components and styles for building beautiful user interfaces. We will see how to install and use Daisy UI within our Vite and Feliz setup, allowing us to easily create visually appealing and responsive web interfaces. Don&#x27;t miss it!</p><div class="my-5 py-5"><a class="btn btn-neutral" href="/blogs">Go Back</a></div></div></article></div></div></div><footer class="footer  p-10 bg-black text-neutral-content"><aside><svg class="me-auto" width="50" height="50" viewBox="-20 -20 100 100"><g id="SvgjsG1201" transform="scale(1.0)" fill="#fff"><path xmlns="http://www.w3.org/2000/svg" d="M2.61,37.02a1.45852,1.45852,0,0,1-.11-.55V4A1.498,1.498,0,0,1,4,2.5H15.77a1.50728,1.50728,0,0,1,1.06.44L27.18,13.29a1.49682,1.49682,0,0,1,0,2.12L5.06,37.53A1.50653,1.50653,0,0,1,2.61,37.02Z"></path><path xmlns="http://www.w3.org/2000/svg" d="M61.5,4V15.77a1.809,1.809,0,0,1-.11.57,1.62577,1.62577,0,0,1-.33.49L50.71,27.18a1.50713,1.50713,0,0,1-2.12,0L26.47,5.06a1.5155,1.5155,0,0,1,.4901-2.45,1.79313,1.79313,0,0,1,.57-.11L60,2.5A1.498,1.498,0,0,1,61.5,4Z"></path><path xmlns="http://www.w3.org/2000/svg" d="M61.39,26.98a1.45841,1.45841,0,0,1,.11.55V60A1.498,1.498,0,0,1,60,61.5H48.23a1.50747,1.50747,0,0,1-1.06-.44L36.82,50.71a1.49678,1.49678,0,0,1,0-2.12L58.94,26.47A1.50658,1.50658,0,0,1,61.39,26.98Z"></path><path xmlns="http://www.w3.org/2000/svg" d="M19.17,30.94,30.94,19.17a1.509,1.509,0,0,1,2.12,0L44.83,30.94a1.50907,1.50907,0,0,1,0,2.12L33.06,44.83a1.51876,1.51876,0,0,1-2.12,0L19.17,33.06A1.50906,1.50906,0,0,1,19.17,30.94Z"></path><path xmlns="http://www.w3.org/2000/svg" d="M37.86,59.45a1.50661,1.50661,0,0,1-1.39,2.05L4,61.5A1.498,1.498,0,0,1,2.5,60V48.23a1.81029,1.81029,0,0,1,.11-.57,1.62669,1.62669,0,0,1,.33-.49L13.29,36.82a1.54761,1.54761,0,0,1,2.12,0L37.53,58.94A1.28931,1.28931,0,0,1,37.86,59.45Z"></path></g></svg><p>Rasheed Aboud.<br/>Providing reliable tech solutions since 2017.</p></aside><nav><header class="footer-title">Social</header><div class="grid grid-flow-col gap-4"><a href="https://twitter.com/@rasheed_aboud"><img alt="twitter" style="max-width:20px;max-height:25px" src="data:image/webp;base64,UklGRowEAABXRUJQVlA4TIAEAAAvMYAMEC8GoY0kSZLnwB/YA/BOZSYNCG0kSZI8B/7AHoB3KjMhtJEkSfIc+AN7AN6pzIQc23bb5gJCUnBaetyG+9+nBtyIB/gxABIDDRUNEwMdFR0NHQ0DEzdctxUoAgeCA4HhwKAwBAIKh8GgUBgMAYcj4BAIBAaHwWEQCAyKDYFBcBAwbCgUhg2FQz8+PuJ5ntvzPLfned6e55GPj4833J/nuaE+z3NDR8MV72joaNs6nrb1bf+wbQu1bWvL3dGWbbRlW7YtWG13W5KQhLYkYRttSUIStnF3tCUJ29hGW/7//0lCEtrSliS0/W37eXfcHUnYxvu+vO9LEu4u25a7y21lG3fH+760JUlsq9vi9/e3tC1J8u/vL5PUtpakbQP2vm+i////c3eWpLzv69vG3bHt/P//Z9tyd/Pu7O7atn13q+1uu+5uJ1nb9rZL276NbbvturudZG07bWcStp0kc5ts+4NAv7+/v5N8fX19fXx+fl4hwbZt045ObNtcsZOybVvB/2Xbtm3btl0dq9x33n2/BRH9N5C2TTsL/T2IDEW3h3gwrjXov79FpJvL/tgTOefM6nWvJ8p/Cmrg8BXDC/OozrclbMo1fDd/hEqnqbDmW5DheehqSfDk+37OTw8X015wzKRjOwy2Y/yLRRyaHSMOiuvw3TX3djHl2TaM+rSSXW0JophRxorP5q5DU6k7w2duYv334aLaD/aaBO2DAa4ktO5ixafRorOwEW6YfFxGWaYL0bOPsPjFOHEzu5zF783dgfoSlYjpZ5n74FewuDoIdnSYOwh9NEJ+3PJxdUqYWNgFLph8WwNpChMfzePMjAixIbeSec/NPfRTW+Rg7Lsl7G+NEzuHwaZZ5k5AT5ORX9ewrTVRbO0Bp01mbXSkkNS6hXXfR4g1hbX4Hpp7Pp+qvM6w9rL03RjxYBqs1lOImnOc+U8miCd7w2Ethb9Tr+K7/SPEGyX14EjhzWLmX/NzYVq4WOmSwrKP5q6Aj8NzosWz/WFPkOleWNsaL94pbYbrSgr+fxIIsytY9FJNISAbDFvblRT6BgDzCp53pLAK0gJCfjXznqopBGR/YJ2aQkAYuxtOaCkkB4DRn1aipPB0HlX5nklq3cwqHyu/mDsHXb0S37qH5R92wkFHCttgiDei5hxjwbMJCxvglpJCRY4XwqddwH/vZ7BklbFUS6G51J6Qn/f8XJraeeEGwK4Oc7thoD0Tny3gxJwoI4UWuKJeZ1vGfFjGvtZ45xXUU2gosWPE97VsnpkkDofAFkcKB2xTSGzbzuqvI11SOGvyZRVl6RbEth5g6buxolFQjf+xIwWfTQoRM04x/8kk0U3RUjgOPa1fuIs94bgjhQ2Q7PbCH+gv3OUxKynUFKiMe7W484XbXcGVn82dha72L9z1Me/XUhiqhOXywi0e8001BSUs44VbmlXGkvfmLkOLywu3diDscEshfNp5/YVbPuaLegohP27rL9z2MS84cfLk0cOHD2+CBpn0et26szMixJND0f0d1D579oxY8Wh3FQA="/></a><a aria-label="YouTube" href="https://www.youtube.com/channel/UCtdi6hMM5p6gAchK67qYPqQ"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill-current"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"></path></svg></a><a aria-label="Facebook" href="https://www.facebook.com/profile.php?id=100078327618426"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill-current"><path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path></svg></a><a href="https://github.com/rasheedaboud"><img alt="Github" style="max-width:25px;max-height:25px" src="data:image/svg+xml,%3c?xml%20version=&#x27;1.0&#x27;%20encoding=&#x27;UTF-8&#x27;%20standalone=&#x27;no&#x27;?%3e%3csvg%20width=&#x27;25&#x27;%20height=&#x27;25&#x27;%20viewBox=&#x27;0%200%2025%2025&#x27;%20version=&#x27;1.1&#x27;%20id=&#x27;svg4&#x27;%20sodipodi:docname=&#x27;github.svg&#x27;%20inkscape:version=&#x27;1.1.1%20(3bf5ae0d25,%202021-09-20)&#x27;%20xmlns:inkscape=&#x27;http://www.inkscape.org/namespaces/inkscape&#x27;%20xmlns:sodipodi=&#x27;http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20xmlns:svg=&#x27;http://www.w3.org/2000/svg&#x27;%3e%3cdefs%20id=&#x27;defs8&#x27;%20/%3e%3csodipodi:namedview%20id=&#x27;namedview6&#x27;%20pagecolor=&#x27;%23ffffff&#x27;%20bordercolor=&#x27;%23666666&#x27;%20borderopacity=&#x27;1.0&#x27;%20inkscape:pageshadow=&#x27;2&#x27;%20inkscape:pageopacity=&#x27;0.0&#x27;%20inkscape:pagecheckerboard=&#x27;0&#x27;%20showgrid=&#x27;false&#x27;%20inkscape:zoom=&#x27;17.458333&#x27;%20inkscape:cx=&#x27;13.431981&#x27;%20inkscape:cy=&#x27;11.97136&#x27;%20inkscape:window-width=&#x27;1920&#x27;%20inkscape:window-height=&#x27;992&#x27;%20inkscape:window-x=&#x27;-8&#x27;%20inkscape:window-y=&#x27;-8&#x27;%20inkscape:window-maximized=&#x27;1&#x27;%20inkscape:current-layer=&#x27;layer1&#x27;%20/%3e%3cg%20inkscape:groupmode=&#x27;layer&#x27;%20id=&#x27;layer1&#x27;%20inkscape:label=&#x27;Layer%201&#x27;%20style=&#x27;display:inline&#x27;%3e%3crect%20style=&#x27;display:inline;fill:%23000000;stroke:%23000000;stroke-width:7.80066&#x27;%20id=&#x27;rect1616&#x27;%20width=&#x27;17.199343&#x27;%20height=&#x27;17.199343&#x27;%20x=&#x27;3.9003301&#x27;%20y=&#x27;3.9003301&#x27;%20/%3e%3cpath%20d=&#x27;m%2012.499999,0.50606967%20c%20-6.6226476,0%20-11.99392933,5.50704133%20-11.99392933,12.29936633%200,5.43427%203.43626083,10.044482%208.20284793,11.671074%200.5986976,0.113769%200.7925992,-0.267511%200.7925992,-0.591395%20V%2021.595384%20C%206.1652056,22.339495%205.4705566,20.144058%205.4705566,20.144058%204.9248328,18.722456%204.1382316,18.344251%204.1382316,18.344251%20c%20-1.088449,-0.763586%200.08296,-0.747188%200.08296,-0.747188%201.2043901,0.0861%201.8380697,1.267861%201.8380697,1.267861%201.0694583,1.879752%202.8055797,1.336531%203.4902334,1.021872%200.1069456,-0.794333%200.417788,-1.337555%200.7616143,-1.644015%20-2.6636519,-0.312609%20-5.4642343,-1.36728%20-5.4642343,-6.078962%200,-1.343706%200.468763,-2.4403988%201.2353746,-3.3013549%20-0.1239379,-0.3105589%20-0.53473,-1.5620194%200.1169404,-3.2552323%200,0%201.0074901,-0.3300329%203.2993304,1.2606851%20C%2010.455036,6.595281%2011.480517,6.458963%2012.500001,6.4538382%20c%201.019484,0.00512%202.045965,0.1414428%203.004479,0.4140787%202.28984,-1.590718%203.295332,-1.2606851%203.295332,-1.2606851%200.65267,1.6942378%200.241878,2.9456983%200.117941,3.2552323%200.76961,0.8609561%201.234375,1.9586729%201.234375,3.3013549%200,4.723982%20-2.80558,5.764303%20-5.476228,6.068713%200.429782,0.38128%200.822584,1.129491%200.822584,2.277432%20v%203.375151%20c%200,0.326959%200.191902,0.711313%200.800594,0.59037%204.76259,-1.628642%208.194852,-6.237829%208.194852,-11.670049%200,-6.792325%20-5.370281,-12.29936633%20-11.993929,-12.29936633%20z&#x27;%20id=&#x27;path2&#x27;%20style=&#x27;display:inline;fill:%23ffffff;stroke:%23000000;stroke-width:1.01214&#x27;%20/%3e%3c/g%3e%3c/svg%3e"/></a></div></nav></footer></main></div>
        <script id="vike_pageContext" type="application/json">{"pageProps":{"blog":{"odata.metadata":"https://rasheedaboudblogstorage.table.core.windows.net/$metadata#blogs/@Element","etag":"W/\"datetime'2024-01-12T23%3A44%3A37.9959913Z'\"","partitionKey":"blogs","rowKey":"part-2-feliz-environment-variables","timestamp":"2024-01-12T23:44:37.9959913Z","author":"Rasheed Aboud","date":"2024-1-2","description":"In Part Two of our blog series, I showed you how to use environment variables and F# conditional compilation in Vite and Feliz-based F# web apps for safer configuration and behavior adjustments across different environments. Stay tuned for integrating Daisy UI in the next installment!","readTime":"5 min","tags":"F#,react,fable,feliz,web development","thumbnail":"https://upload.wikimedia.org/wikipedia/commons/thumb/6/66/F_Sharp_logo.svg/1200px-F_Sharp_logo.svg.png","title":"Part 2-Feliz Environment Variables","markdown":"## TL;DR\r\n\r\nIn Part 2 of the F# web development series with Vite and Feliz, we learn how to manage environment variables in F# applications for different environments like development, testing, and production. We discuss storing sensitive data outside the code, accessing it in a type-safe manner through .env files, and conditional compilation using F# #if/#else directives. The post provides code snippets for setting up environment variables and using compiler directives to alter app behavior conditionally. This enhances app flexibility, security, and configurability. Stay tuned for the next part, which will focus on integrating Daisy UI for better UI components.\r\n\r\n## Background\r\n\r\nWelcome back to the second part of our blog series on F# web development with Vite and Feliz. In the previous post, we set up our development environment and built a basic web application. Now, we will dive into the topic of environment variables and how they can change how our app's behave in different environments.\r\n\r\nFor the record you should **NEVER** expose any sensitive information in a client application like a web browser! They are inherently not secure. Using environment variables in client to test or change application behavior that does not leak sensitive information is an acceptable use case.\r\n\r\nBy using environment variables, we can easily configure our app's behavior in different environments without hardcoding values. This allows for greater flexibility and control of how are application behave.\r\n\r\nWe will start by learning how to read environment variables in our F# code using the Vite build tool. Then, we will see how to store variables in .env files and access them in a type-safe manner. Additionally, we will explore the concept of F# conditional compilation and its role in controlling the behavior of our app based on different environments. \r\n\r\nBy the end of this post, you will have a solid understanding of how to leverage environment variables and conditional compilation in your F# web applications, bringing greater flexibility, security, and configurability to your projects.\r\n\r\nLet's dive in!\r\n\r\n## Prerequisites\r\n\r\nGrab the code form [Part 1](https://github.com/rasheedaboud/FSharp-Web-Development/tree/main/Part%201%20-Getting%20Started). It should contain all the required bits to get going.\r\n\r\nHere is a short list of the requirements to run the app:\r\n\r\n- .Net 8\r\n- Node ^18\r\n- npm | pnpm | yarn\r\n- [Visual Studio Code](https://code.visualstudio.com/) with [Ionide](http://ionide.io/)\r\n- [Highlight templates in F#](https://marketplace.visualstudio.com/items?itemName=alfonsogarciacaro.vscode-template-fsharp-highlight)\r\n\r\n## Getting Started\r\n\r\nFirst thing were going to do is introduce environment variables. Were going to need them eventually. You can read about how vite deals with .env files and variables [here](https://vitejs.dev/guide/env-and-mode.html). The short and sweet of it is you can add a ```.env``` file to your repo, and add any 'config' values that you may want to use during testing or development.\r\n\r\nBy placing any the following files in the **src** folder;\r\n\r\n- ```.env```\r\n- ```.env.local```\r\n- ```.env.production```\r\n\r\nYou can control what get checked into source control and change how you app behaves in different environments. Although when you publish your app there are better / more secure ways of storing real secrets!\r\n\r\nFirst things first we need a way to read the values we store in the ```.env``` files.\r\n\r\nIn JavaScript we could just do the following:\r\n\r\n```js\r\nimport.meta.env.VITE_SOME_KEY\r\n```\r\n\r\nIn F# just like in typescript if we want to access these environment variables in a type safe manner there is a bit of setup. I guarantee there is a much nicer / more elegant way of doing this but i find it works well for me.\r\n\r\nIn  ```/src``` directory create a new F# file, I call mine ```Env.fs``` and add the following code:\r\n\r\n```fsharp\r\n[\u003cRequireQualifiedAccess>]\r\nmodule Env\r\n\r\n    open Fable.Core\r\n\r\n    [\u003cEmit(\"import.meta.env.VITE_KEY\")>]\r\n    let vite_key: string = jsNative\r\n```\r\n\r\nNext add the following to a file called ```.env``` located in the ```./src``` folder:\r\n\r\n```env\r\nVITE_KEY=\"SOME VALUE\"\r\n```\r\n\r\nSimilar to setting up a typescript definition file for your vite variables this will now give you access to the value of a variable called 'VITE_KEY'.\r\n\r\nYou can test this by printing the value to the console.\r\n\r\n```Main.fs```\r\n\r\n```fsharp\r\nmodule Main\r\n\r\nopen Feliz\r\nopen App\r\nopen Browser.Dom\r\n\r\nconsole.log(Env.vite_key)\r\n\r\nlet root = ReactDOM.createRoot (document.getElementById \"feliz-app\")\r\nroot.render (Components.Counter())\r\n```\r\nWhich should output ```SOME VALUE``` to the dev console in your browser.\r\n\r\nIf you want some extra type safety you could do the following back in the ```Env.fs``` file.\r\n\r\n```fsharp\r\n[\u003cRequireQualifiedAccess>]\r\nmodule Env\r\n\r\nopen Fable.Core\r\n\r\n[\u003cRequireQualifiedAccess>]\r\nmodule ViteKey =\r\n\r\n    [\u003cLiteral>]\r\n    let private key = \"import.meta.env.VITE_KEY\"\r\n\r\n    [\u003cEmit(key)>]\r\n    let private vite_key_maybe: string option = jsNative\r\n\r\n    let value =\r\n        match vite_key_maybe with\r\n        | Some envValue -> envValue\r\n        | None -> failwith $\"no env variable with name:{key}  found.\"\r\n```\r\n\r\n```fsharp\r\nmodule Main\r\n\r\nopen Feliz\r\nopen App\r\nopen Browser.Dom\r\nopen Fable.Core.JsInterop\r\n\r\nconsole.log(Env.ViteKey.value)\r\n\r\nlet root = ReactDOM.createRoot (document.getElementById \"feliz-app\")\r\nroot.render (Components.Home())\r\n```\r\nInstead of throwing an error you could also return whatever you want.\r\n\r\nIf you're curious about the weird ```[\u003cEmit(\"import.meta.env.VITE_KEY\")>]``` syntax. This a way to call arbitrary javascript methods from F#. Zaid made an excellent post about it back in 2017 that you can [here](https://medium.com/@zaid.naom/f-interop-with-javascript-in-fable-the-complete-guide-ccc5b896a59f). Dont worry too much we'll dig a little deeper into Javascript interop later on.\r\n\r\n## F# Conditional Compilation\r\n\r\nAnother way of conditionally changing how you app behaves is using F# conditional compilation ```#if #else``` blocks in your source code. You can learn all about [compiler directives](https://learn.microsoft.com/en-us/dotnet/fsharp/language-reference/compiler-directives) from the microsoft docs.\r\n\r\nAlfonso Garcia wrote an excellent blog post about how this topic called '[When Fable and F# bring you better tooling than JS](https://fable.io/blog/2022/2022-10-26-hot-reload.html)'. He gives some great examples of how using F# and .Net can actually give you a better dev experience than the native tooling available in the javascript ecosystem.\r\n\r\nHere is a contrived example of how this would look:\r\n```fsharp\r\nmodule Main\r\n\r\nopen Feliz\r\nopen App\r\nopen Browser.Dom\r\n\r\n#if DEBUG\r\nconsole.log (\"This will only print if environment is set to debug\")\r\n#endif\r\n\r\nconsole.log (Env.ViteKey.value)\r\n\r\nlet root = ReactDOM.createRoot (document.getElementById \"feliz-app\")\r\nroot.render (Components.Counter())\r\n\r\n```\r\n\r\n## Summary\r\n\r\nIn this blog post, we explored how to use environment variables in our F# web application built with Vite and Feliz. We learned how to access environment variables defined in the .env files and store them in F# modules for type-safe access. We also looked at using F# conditional compilation to conditionally change the behavior of our app based on different environments.\r\n\r\nBy using environment variables, we can easily configure our app's behavior in different environments without hardcoding values. This allows for greater flexibility and control of how are application behave.\r\n\r\nOverall, leveraging environment variables in our F# web application helps us build more configurable apps with a smoother development experience.\r\n\r\nStay tuned for Part 3 of this blog series, where we will explore how to integrate [Daisy UI](https://daisyui.com/docs/install/) into our F# web application. Daisy UI is a powerful UI library that provides ready-to-use components and styles for building beautiful user interfaces. We will see how to install and use Daisy UI within our Vite and Feliz setup, allowing us to easily create visually appealing and responsive web interfaces. Don't miss it!\r\n"}},"urlPathname":"/blog/part-2-feliz-environment-variables","routeParams":{"pageTitle":"part-2-feliz-environment-variables"},"documentProps":{"title":"Part 2-Feliz Environment Variables","description":"In Part Two of our blog series, I showed you how to use environment variables and F# conditional compilation in Vite and Feliz-based F# web apps for safer configuration and behavior adjustments across different environments. Stay tuned for integrating Daisy UI in the next installment!"},"abortReason":"!undefined","_urlRewrite":null,"_urlRedirect":"!undefined","abortStatusCode":"!undefined","_abortCall":"!undefined","_pageContextInitIsPassedToClient":"!undefined","_pageId":"/pages/blog/@pageTitle","data":"!undefined"}</script>
        <script src="/assets/entries/entry-server-routing.k9R1TJMz.js" type="module" async></script>
        <link rel="modulepreload" href="/assets/entries/pages_blog_-pageTitle.dLvouTYp.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/assets/chunks/chunk-nCmu2GNS.js" as="script" type="text/javascript">
      </body>
    </html>