<!DOCTYPE html>
    <html data-theme="light" lang="en">
      <head>
        <link rel="stylesheet" type="text/css" href="/assets/static/onRenderClient.Zjt8Mx4J.css">
        <meta charset="UTF-8" />
        <meta name="google-site-verification" content="tasigl22802n6H-QTcOM1o96ZEKow4vzIU36DCZwO4g" />
        <meta http-equiv='cache-control' content='no-cache'> 
        <meta http-equiv='expires' content='0'> 
        <meta http-equiv='pragma' content='no-cache'>
        <link rel="icon" href="/assets/static/favicon.D7K9RfVp.ico" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="In the post, two methods of state management in Feliz are demonstrated for an F# web application: the `useElmish` hook for Elmish-style state management and the `useState` hook for simpler state updates. A temperature converter example is used to illustrate both approaches, which are then integrated into a router." />
        <title>Part 4-State Management in Feliz</title>
      </head>
      <body>
        <div id="react-root"><main class="min-h-screen"><header><nav class="bg-black"><div class="mx-auto max-w-7xl px-2 sm:px-6 lg:px-1"><div class="relative flex h-16 items-center justify-between"><div class="absolute inset-y-0 left-0 flex items-center sm:hidden"><button type="button" class="relative inline-flex items-center justify-center rounded-md p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white" aria-controls="mobile-menu" aria-expanded="false"><span class="absolute -inset-0.5"></span><span class="sr-only">Open main menu</span><svg class="block h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path></svg></button></div><div class="flex flex-1 items-center justify-end sm:items-stretch sm:justify-start"><div class="hidden sm:flex flex-shrink-0 items-center"><svg class="me-auto" width="50" height="50" viewBox="-20 -20 100 100"><g id="SvgjsG1201" transform="scale(1.0)" fill="#fff"><path xmlns="http://www.w3.org/2000/svg" d="M2.61,37.02a1.45852,1.45852,0,0,1-.11-.55V4A1.498,1.498,0,0,1,4,2.5H15.77a1.50728,1.50728,0,0,1,1.06.44L27.18,13.29a1.49682,1.49682,0,0,1,0,2.12L5.06,37.53A1.50653,1.50653,0,0,1,2.61,37.02Z"></path><path xmlns="http://www.w3.org/2000/svg" d="M61.5,4V15.77a1.809,1.809,0,0,1-.11.57,1.62577,1.62577,0,0,1-.33.49L50.71,27.18a1.50713,1.50713,0,0,1-2.12,0L26.47,5.06a1.5155,1.5155,0,0,1,.4901-2.45,1.79313,1.79313,0,0,1,.57-.11L60,2.5A1.498,1.498,0,0,1,61.5,4Z"></path><path xmlns="http://www.w3.org/2000/svg" d="M61.39,26.98a1.45841,1.45841,0,0,1,.11.55V60A1.498,1.498,0,0,1,60,61.5H48.23a1.50747,1.50747,0,0,1-1.06-.44L36.82,50.71a1.49678,1.49678,0,0,1,0-2.12L58.94,26.47A1.50658,1.50658,0,0,1,61.39,26.98Z"></path><path xmlns="http://www.w3.org/2000/svg" d="M19.17,30.94,30.94,19.17a1.509,1.509,0,0,1,2.12,0L44.83,30.94a1.50907,1.50907,0,0,1,0,2.12L33.06,44.83a1.51876,1.51876,0,0,1-2.12,0L19.17,33.06A1.50906,1.50906,0,0,1,19.17,30.94Z"></path><path xmlns="http://www.w3.org/2000/svg" d="M37.86,59.45a1.50661,1.50661,0,0,1-1.39,2.05L4,61.5A1.498,1.498,0,0,1,2.5,60V48.23a1.81029,1.81029,0,0,1,.11-.57,1.62669,1.62669,0,0,1,.33-.49L13.29,36.82a1.54761,1.54761,0,0,1,2.12,0L37.53,58.94A1.28931,1.28931,0,0,1,37.86,59.45Z"></path></g></svg></div><div class="sm:ml-6 sm:block"><div class="flex space-x-4"><a href="/" class="text-gray-300 hover:bg-gray-700 hover:text-white rounded-md px-1 py-3 text-lg font-black" aria-current="page">Rasheed Aboud</a></div></div></div><div class="hidden  sm:flex absolute inset-y-0 right-0  items-center pr-2 sm:static sm:inset-auto sm:ml-6 sm:pr-0"><a href="/blogs" class="text-gray-300 hover:bg-gray-700 hover:text-white rounded-md px-3 py-2 text-sm font-black">Blog</a><a href="/about" class="text-gray-300 hover:bg-gray-700 hover:text-white rounded-md px-3 py-2 text-sm font-black">About</a><a href="/contact" class="text-gray-300 hover:bg-gray-700 hover:text-white rounded-md px-3 py-2 text-sm font-black">Contact</a></div></div></div></nav></header><div class="container mx-auto px-4 py-1"><div><div class="min-h-svh sm:px-10 md:px-24 lg:px-48"><article><div style="min-width:100% !important" class="prose"><div class="absolute right-1/2 bottom-1/2  transform translate-x-1/2 translate-y-1/2 "><div class="border-t-transparent border-solid animate-spin  rounded-full border-black border-8 h-32 w-32"></div></div></div></article></div></div></div><footer class="footer  p-10 bg-black text-neutral-content"><aside><svg class="me-auto" width="50" height="50" viewBox="-20 -20 100 100"><g id="SvgjsG1201" transform="scale(1.0)" fill="#fff"><path xmlns="http://www.w3.org/2000/svg" d="M2.61,37.02a1.45852,1.45852,0,0,1-.11-.55V4A1.498,1.498,0,0,1,4,2.5H15.77a1.50728,1.50728,0,0,1,1.06.44L27.18,13.29a1.49682,1.49682,0,0,1,0,2.12L5.06,37.53A1.50653,1.50653,0,0,1,2.61,37.02Z"></path><path xmlns="http://www.w3.org/2000/svg" d="M61.5,4V15.77a1.809,1.809,0,0,1-.11.57,1.62577,1.62577,0,0,1-.33.49L50.71,27.18a1.50713,1.50713,0,0,1-2.12,0L26.47,5.06a1.5155,1.5155,0,0,1,.4901-2.45,1.79313,1.79313,0,0,1,.57-.11L60,2.5A1.498,1.498,0,0,1,61.5,4Z"></path><path xmlns="http://www.w3.org/2000/svg" d="M61.39,26.98a1.45841,1.45841,0,0,1,.11.55V60A1.498,1.498,0,0,1,60,61.5H48.23a1.50747,1.50747,0,0,1-1.06-.44L36.82,50.71a1.49678,1.49678,0,0,1,0-2.12L58.94,26.47A1.50658,1.50658,0,0,1,61.39,26.98Z"></path><path xmlns="http://www.w3.org/2000/svg" d="M19.17,30.94,30.94,19.17a1.509,1.509,0,0,1,2.12,0L44.83,30.94a1.50907,1.50907,0,0,1,0,2.12L33.06,44.83a1.51876,1.51876,0,0,1-2.12,0L19.17,33.06A1.50906,1.50906,0,0,1,19.17,30.94Z"></path><path xmlns="http://www.w3.org/2000/svg" d="M37.86,59.45a1.50661,1.50661,0,0,1-1.39,2.05L4,61.5A1.498,1.498,0,0,1,2.5,60V48.23a1.81029,1.81029,0,0,1,.11-.57,1.62669,1.62669,0,0,1,.33-.49L13.29,36.82a1.54761,1.54761,0,0,1,2.12,0L37.53,58.94A1.28931,1.28931,0,0,1,37.86,59.45Z"></path></g></svg><p>Rasheed Aboud.<br/>Providing reliable tech solutions since 2017.</p></aside><nav><header class="footer-title">Social</header><div class="grid grid-flow-col gap-4"><a href="https://twitter.com/@rasheed_aboud"><img alt="twitter" style="max-width:20px;max-height:25px" src="data:image/webp;base64,UklGRowEAABXRUJQVlA4TIAEAAAvMYAMEC8GoY0kSZLnwB/YA/BOZSYNCG0kSZI8B/7AHoB3KjMhtJEkSfIc+AN7AN6pzIQc23bb5gJCUnBaetyG+9+nBtyIB/gxABIDDRUNEwMdFR0NHQ0DEzdctxUoAgeCA4HhwKAwBAIKh8GgUBgMAYcj4BAIBAaHwWEQCAyKDYFBcBAwbCgUhg2FQz8+PuJ5ntvzPLfned6e55GPj4833J/nuaE+z3NDR8MV72joaNs6nrb1bf+wbQu1bWvL3dGWbbRlW7YtWG13W5KQhLYkYRttSUIStnF3tCUJ29hGW/7//0lCEtrSliS0/W37eXfcHUnYxvu+vO9LEu4u25a7y21lG3fH+760JUlsq9vi9/e3tC1J8u/vL5PUtpakbQP2vm+i////c3eWpLzv69vG3bHt/P//Z9tyd/Pu7O7atn13q+1uu+5uJ1nb9rZL276NbbvturudZG07bWcStp0kc5ts+4NAv7+/v5N8fX19fXx+fl4hwbZt045ObNtcsZOybVvB/2Xbtm3btl0dq9x33n2/BRH9N5C2TTsL/T2IDEW3h3gwrjXov79FpJvL/tgTOefM6nWvJ8p/Cmrg8BXDC/OozrclbMo1fDd/hEqnqbDmW5DheehqSfDk+37OTw8X015wzKRjOwy2Y/yLRRyaHSMOiuvw3TX3djHl2TaM+rSSXW0JophRxorP5q5DU6k7w2duYv334aLaD/aaBO2DAa4ktO5ixafRorOwEW6YfFxGWaYL0bOPsPjFOHEzu5zF783dgfoSlYjpZ5n74FewuDoIdnSYOwh9NEJ+3PJxdUqYWNgFLph8WwNpChMfzePMjAixIbeSec/NPfRTW+Rg7Lsl7G+NEzuHwaZZ5k5AT5ORX9ewrTVRbO0Bp01mbXSkkNS6hXXfR4g1hbX4Hpp7Pp+qvM6w9rL03RjxYBqs1lOImnOc+U8miCd7w2Ethb9Tr+K7/SPEGyX14EjhzWLmX/NzYVq4WOmSwrKP5q6Aj8NzosWz/WFPkOleWNsaL94pbYbrSgr+fxIIsytY9FJNISAbDFvblRT6BgDzCp53pLAK0gJCfjXznqopBGR/YJ2aQkAYuxtOaCkkB4DRn1aipPB0HlX5nklq3cwqHyu/mDsHXb0S37qH5R92wkFHCttgiDei5hxjwbMJCxvglpJCRY4XwqddwH/vZ7BklbFUS6G51J6Qn/f8XJraeeEGwK4Oc7thoD0Tny3gxJwoI4UWuKJeZ1vGfFjGvtZ45xXUU2gosWPE97VsnpkkDofAFkcKB2xTSGzbzuqvI11SOGvyZRVl6RbEth5g6buxolFQjf+xIwWfTQoRM04x/8kk0U3RUjgOPa1fuIs94bgjhQ2Q7PbCH+gv3OUxKynUFKiMe7W484XbXcGVn82dha72L9z1Me/XUhiqhOXywi0e8001BSUs44VbmlXGkvfmLkOLywu3diDscEshfNp5/YVbPuaLegohP27rL9z2MS84cfLk0cOHD2+CBpn0et26szMixJND0f0d1D579oxY8Wh3FQA="/></a><a aria-label="YouTube" href="https://www.youtube.com/channel/UCtdi6hMM5p6gAchK67qYPqQ"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill-current"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"></path></svg></a><a aria-label="Facebook" href="https://www.facebook.com/profile.php?id=100078327618426"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill-current"><path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path></svg></a><a href="https://github.com/rasheedaboud"><img alt="Github" style="max-width:25px;max-height:25px" src="data:image/svg+xml,%3c?xml%20version=&#x27;1.0&#x27;%20encoding=&#x27;UTF-8&#x27;%20standalone=&#x27;no&#x27;?%3e%3csvg%20width=&#x27;25&#x27;%20height=&#x27;25&#x27;%20viewBox=&#x27;0%200%2025%2025&#x27;%20version=&#x27;1.1&#x27;%20id=&#x27;svg4&#x27;%20sodipodi:docname=&#x27;github.svg&#x27;%20inkscape:version=&#x27;1.1.1%20(3bf5ae0d25,%202021-09-20)&#x27;%20xmlns:inkscape=&#x27;http://www.inkscape.org/namespaces/inkscape&#x27;%20xmlns:sodipodi=&#x27;http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20xmlns:svg=&#x27;http://www.w3.org/2000/svg&#x27;%3e%3cdefs%20id=&#x27;defs8&#x27;%20/%3e%3csodipodi:namedview%20id=&#x27;namedview6&#x27;%20pagecolor=&#x27;%23ffffff&#x27;%20bordercolor=&#x27;%23666666&#x27;%20borderopacity=&#x27;1.0&#x27;%20inkscape:pageshadow=&#x27;2&#x27;%20inkscape:pageopacity=&#x27;0.0&#x27;%20inkscape:pagecheckerboard=&#x27;0&#x27;%20showgrid=&#x27;false&#x27;%20inkscape:zoom=&#x27;17.458333&#x27;%20inkscape:cx=&#x27;13.431981&#x27;%20inkscape:cy=&#x27;11.97136&#x27;%20inkscape:window-width=&#x27;1920&#x27;%20inkscape:window-height=&#x27;992&#x27;%20inkscape:window-x=&#x27;-8&#x27;%20inkscape:window-y=&#x27;-8&#x27;%20inkscape:window-maximized=&#x27;1&#x27;%20inkscape:current-layer=&#x27;layer1&#x27;%20/%3e%3cg%20inkscape:groupmode=&#x27;layer&#x27;%20id=&#x27;layer1&#x27;%20inkscape:label=&#x27;Layer%201&#x27;%20style=&#x27;display:inline&#x27;%3e%3crect%20style=&#x27;display:inline;fill:%23000000;stroke:%23000000;stroke-width:7.80066&#x27;%20id=&#x27;rect1616&#x27;%20width=&#x27;17.199343&#x27;%20height=&#x27;17.199343&#x27;%20x=&#x27;3.9003301&#x27;%20y=&#x27;3.9003301&#x27;%20/%3e%3cpath%20d=&#x27;m%2012.499999,0.50606967%20c%20-6.6226476,0%20-11.99392933,5.50704133%20-11.99392933,12.29936633%200,5.43427%203.43626083,10.044482%208.20284793,11.671074%200.5986976,0.113769%200.7925992,-0.267511%200.7925992,-0.591395%20V%2021.595384%20C%206.1652056,22.339495%205.4705566,20.144058%205.4705566,20.144058%204.9248328,18.722456%204.1382316,18.344251%204.1382316,18.344251%20c%20-1.088449,-0.763586%200.08296,-0.747188%200.08296,-0.747188%201.2043901,0.0861%201.8380697,1.267861%201.8380697,1.267861%201.0694583,1.879752%202.8055797,1.336531%203.4902334,1.021872%200.1069456,-0.794333%200.417788,-1.337555%200.7616143,-1.644015%20-2.6636519,-0.312609%20-5.4642343,-1.36728%20-5.4642343,-6.078962%200,-1.343706%200.468763,-2.4403988%201.2353746,-3.3013549%20-0.1239379,-0.3105589%20-0.53473,-1.5620194%200.1169404,-3.2552323%200,0%201.0074901,-0.3300329%203.2993304,1.2606851%20C%2010.455036,6.595281%2011.480517,6.458963%2012.500001,6.4538382%20c%201.019484,0.00512%202.045965,0.1414428%203.004479,0.4140787%202.28984,-1.590718%203.295332,-1.2606851%203.295332,-1.2606851%200.65267,1.6942378%200.241878,2.9456983%200.117941,3.2552323%200.76961,0.8609561%201.234375,1.9586729%201.234375,3.3013549%200,4.723982%20-2.80558,5.764303%20-5.476228,6.068713%200.429782,0.38128%200.822584,1.129491%200.822584,2.277432%20v%203.375151%20c%200,0.326959%200.191902,0.711313%200.800594,0.59037%204.76259,-1.628642%208.194852,-6.237829%208.194852,-11.670049%200,-6.792325%20-5.370281,-12.29936633%20-11.993929,-12.29936633%20z&#x27;%20id=&#x27;path2&#x27;%20style=&#x27;display:inline;fill:%23ffffff;stroke:%23000000;stroke-width:1.01214&#x27;%20/%3e%3c/g%3e%3c/svg%3e"/></a></div></nav></footer></main></div>
        <script id="vike_pageContext" type="application/json">{"pageProps":{"blog":{"odata.metadata":"https://rasheedaboudblogstorage.table.core.windows.net/$metadata#blogs/@Element","etag":"W/\"datetime'2024-01-12T23%3A53%3A26.4411983Z'\"","partitionKey":"blogs","rowKey":"part-4-state-management-in-feliz","timestamp":"2024-01-12T23:53:26.4411983Z","author":"Rasheed Aboud","date":"2024-1-4","description":"In the post, two methods of state management in Feliz are demonstrated for an F# web application: the `useElmish` hook for Elmish-style state management and the `useState` hook for simpler state updates. A temperature converter example is used to illustrate both approaches, which are then integrated into a router.","readTime":"6 min","tags":"F#,react,fable,feliz,web development,elmish","thumbnail":"https://rasheedaboudblogstorage.blob.core.windows.net/blogs/elmish.webp?sp=r&st=2024-01-07T01:36:32Z&se=2050-01-07T09:36:32Z&spr=https&sv=2022-11-02&sr=b&sig=%2FrX7E%2BR6hIaMtIqvzi1dAZntHCaHYup4sXQGIl18PxE%3D","title":"Part 4-State Management in Feliz","markdown":"## TL;DR\r\n\r\nThis article provides a tutorial on managing state in a web application using F# with Feliz and Fable. It demonstrates two methods of state management—using the `useElmish` hook for an Elmish pattern approach and the `useState` hook for more direct state management. The post walks through the creation of a simple temperature converter application as an example. The `useElmish` method employs a model-update-view architecture that's more suitable for complex applications. In contrast, the `useState` method handles state changes within the component and may be favored for simpler state requirements. The article also introduces `useContext` for global state access and updates in a React application using F#. All code examples are available in the article's repository, along with instructions on how to run them. The post is part of a series on F# web development and aims to progressively build out features in a web application.\r\n\r\n## Background\r\n\r\nWelcome back to our series on building web applications using F# with Feliz and Fable! In our previous post, we delved into constructing a UI using the Feliz.DaisyUI library. Today, we will be moving a step further into the realm of interactivity by introducing state management to our application.\r\n\r\nThere are a few ways this can be accomplished in a Javascript react application, to name a few we have the inbuilt\r\n\r\n- [useState](https://www.w3schools.com/react/react_usestate.asp)\r\n- [useContext](https://www.w3schools.com/react/react_usecontext.asp)\r\n\r\nWe have third party libraries like:\r\n\r\n- [Redux](https://redux.js.org/)\r\n- [Recoil](https://recoiljs.org/)\r\n- [MobX](https://mobx.js.org/README.html)\r\n\r\nToday we will go over a couple options for state management in Feliz. We will start with ``React.useState`` hook and also another very popular approached called **[elmish](https://elmish.github.io/elmish/)** using ```React.useElmish``` hook. I peronally really like the elmish approach, however they are not mutually exclusive. They can be used alone or together as you see fit.\r\n\r\n## The Plan\r\n\r\nFor this demonstration, we will build a simple temperature converter form. You will be able to input a temperature in Celsius and get the equivalent in Fahrenheit, and vice versa. Let's start by setting up the model, which will represent the state for our form. First we will do it using ```useElmish``` and then we will re-implement it with ```useState```. Hopefully this will illustrate how to use them effectively.\r\n\r\n## Prerequisites\r\n\r\nGrab the code form [Part 3](https://github.com/rasheedaboud/FSharp-Web-Development/tree/main/Part%203%20-Building%20UI). It should contain all the required bits to get going.\r\n\r\nHere is a short list of the requirements to run the app:\r\n\r\n- .Net 8\r\n- Node ^18\r\n- npm | pnpm | yarn\r\n- [Visual Studio Code](https://code.visualstudio.com/) with [Ionide](http://ionide.io/)\r\n- [Highlight templates in F#](https://marketplace.visualstudio.com/items?itemName=alfonsogarciacaro.vscode-template-fsharp-highlight)\r\n\r\n\r\n## Elmish Approach\r\n\r\n### Setting Up the Model\r\n\r\nFirst let's create a new F# file called ``ElmishConverter.fs``. \r\n\r\nOur state needs to store both the current temperature and the unit it represents. Here's what our state will look like:\r\n```fsharp\r\nmodule ElmishConverter\r\n\r\ntype TemperatureScale =\r\n    | Celsius\r\n    | Fahrenheit\r\n\r\n    member this.Value =\r\n        match this with\r\n        | Celsius -> nameof Celsius\r\n        | Fahrenheit -> nameof Fahrenheit\r\n\r\ntype State =\r\n    { Temperature: decimal\r\n      Scale: TemperatureScale }\r\n\r\nlet init () =\r\n    { Temperature = -20.0; Scale = Celsius }\r\n```\r\n\r\nNext, we define messages that represent all possible updates to our state:\r\n```fsharp\r\ntype Msg =\r\n    | UpdateTemperature of string\r\n    | ChangeScale\r\n```\r\n\r\n### Implementing the Update Function\r\nThe update function will handle the transformation of our state in response to messages:\r\n\r\n```fsharp\r\nlet validTemp temp =\r\n  if String.IsNullOrEmpty(temp) then 0.0m else decimal temp\r\n\r\nlet update msg state =\r\n  match msg with\r\n  | UpdateTemperature temp ->\r\n\r\n    {\r\n      state with\r\n          Temperature = validTemp temp\r\n    },\r\n    Cmd.none\r\n  | ChangeScale ->\r\n    match state.Scale with\r\n    | Celsius ->\r\n      let convert = (state.Temperature * 9.0m / 5.0m) + 32.0m\r\n\r\n      {\r\n        state with\r\n            Scale = Fahrenheit\r\n            Temperature = convert\r\n      },\r\n      Cmd.none\r\n\r\n    | Fahrenheit ->\r\n      let convert = (state.Temperature - 32.0m) * 5.0m / 9.0m\r\n\r\n      {\r\n        state with\r\n            Scale = Celsius\r\n            Temperature = convert\r\n      },\r\n      Cmd.none\r\n```\r\n\r\n### Crafting the View\r\n\r\nThe view function will take our state and render it. We will perform the temperature conversion within the view for simplicity:\r\n\r\n```fsharp\r\nlet view (state: State) dispatch =\r\n  Html.div [\r\n    prop.className \"grid grid-flow-row auto-rows-max\"\r\n    prop.children [\r\n      Daisy.label [ prop.htmlFor \"temperature-input\"; prop.text \"Enter Temperature:\" ]\r\n\r\n      Daisy.input [\r\n        prop.id \"temperature-input\"\r\n        prop.type' \"text\"\r\n        prop.placeholder \"Temperature\"\r\n        prop.value (string state.Temperature)\r\n        prop.onChange (fun e -> dispatch (UpdateTemperature e))\r\n      ]\r\n\r\n      Daisy.button.button [\r\n        prop.classes [ \"btn\"; \"btn-primary\"; \"my-2\" ]\r\n        prop.onClick (fun _ -> dispatch ChangeScale)\r\n        if state.Scale = Celsius then\r\n          prop.text \"Convert to Fahrenheit\"\r\n        else\r\n          prop.text \"Convert to Celsius\"\r\n      ]\r\n\r\n      Html.div [\r\n        prop.classes [ \"text-lg\"; \"font-bold\"; \"pt-4\" ]\r\n        prop.text (sprintf \"Temperature: %.2f° %s\" state.Temperature state.Scale.Value)\r\n      ]\r\n    ]\r\n  ]\r\n```\r\n### Employing `useElmish`\r\nWith the state, messages, update, and view defined, we now hook them up by using the `useElmish` hook in our component:\r\n\r\n```fsharp\r\n[\u003cReactComponent>]\r\nlet TemperatureConverter () =\r\n  let (state, dispatch) = React.useElmish (init, update)\r\n  view state dispatch\r\n```\r\n\r\nNow add a reference to the package ``Feliz.UseElmish``.\r\n\r\n```console\r\nfemto install Feliz.UseElmish ./src\r\n```\r\nBack in our ``Components/fs`` update the router to show our new page when we navigate to ``/#elmish-converter``:\r\n\r\n```fsharp\r\n  [\u003cReactComponent>]\r\n  static member Router() =\r\n    let (currentUrl, updateUrl) = React.useState (Router.currentUrl ())\r\n\r\n    Html.div\r\n      [ Components.NavBar()\r\n        React.router\r\n          [ router.onUrlChanged updateUrl\r\n            router.children\r\n              [ match currentUrl with\r\n                | [] -> Components.Home()\r\n                | [ \"elmish-converter\" ] -> ElmishConverter.TemperatureConverter()\r\n                | otherwise -> Html.h1 \"Not found\" ] ] ]\r\n```\r\n\r\n\r\nAnd that's it! You now have a simple but interactive temperature converter built with F# and Feliz using the Elmish pattern. Although this is a small example, `useElmish` can be scaled to manage state for more complex components and applications while keeping your codebase organized and robust.\r\n\r\n## State with ```useState```\r\n\r\nOur state will be identical to the previous example provided:\r\n\r\n```fsharp\r\ntype TemperatureScale =\r\n  | Celsius\r\n  | Fahrenheit\r\n\r\n  member this.Value =\r\n    match this with\r\n    | Celsius -> nameof Celsius\r\n    | Fahrenheit -> nameof Fahrenheit\r\n\r\ntype State = {\r\n  Temperature: decimal\r\n  Scale: TemperatureScale\r\n}\r\n\r\nlet init =\r\n  {\r\n    Temperature = -20.0m\r\n    Scale = Celsius\r\n  }\r\n```\r\n\r\nWe wont need the update function anymore, instead we will be dealing with all UI changes inside our component.\r\n\r\n```fsharp\r\n[\u003cReactComponent>]\r\nlet Converter () =\r\n\r\n  let state, setState = React.useState (init)\r\n\r\n  let changeScale (evt: MouseEvent) =\r\n    match state.Scale with\r\n    | Celsius ->\r\n      let convert = (state.Temperature * 9.0m / 5.0m) + 32.0m\r\n\r\n      setState (\r\n        {\r\n          state with\r\n              Scale = Fahrenheit\r\n              Temperature = convert\r\n        }\r\n      )\r\n    | Fahrenheit ->\r\n      let convert = (state.Temperature - 32.0m) * 5.0m / 9.0m\r\n\r\n      setState (\r\n        {\r\n          state with\r\n              Scale = Celsius\r\n              Temperature = convert\r\n        }\r\n      )\r\n\r\n  let updateTemperature (temp: string) =\r\n    setState (\r\n      {\r\n        state with\r\n            Temperature = validTemp temp\r\n      }\r\n    )\r\n\r\n  Html.div [\r\n    prop.className \"grid grid-flow-row auto-rows-max\"\r\n    prop.children [\r\n      Daisy.label [ prop.htmlFor \"temperature-input\"; prop.text \"Enter Temperature:\" ]\r\n\r\n      Daisy.input [\r\n        prop.id \"temperature-input\"\r\n        prop.type' \"text\"\r\n        prop.placeholder \"Temperature\"\r\n        prop.value (string state.Temperature)\r\n        prop.onChange updateTemperature\r\n      ]\r\n\r\n      Daisy.button.button [\r\n        prop.classes [ \"btn\"; \"btn-primary\"; \"my-2\" ]\r\n        prop.onClick changeScale\r\n        if state.Scale = Celsius then\r\n          prop.text \"Convert to Fahrenheit\"\r\n        else\r\n          prop.text \"Convert to Celsius\"\r\n      ]\r\n\r\n      Html.div [\r\n        prop.classes [ \"text-lg\"; \"font-bold\"; \"pt-4\" ]\r\n        prop.text (sprintf \"Temperature: %.2f° %s\" state.Temperature state.Scale.Value)\r\n      ]\r\n    ]\r\n  ]\r\n```\r\nAdd our new component to the router:\r\n\r\n```fsharp\r\n      React.router [\r\n        router.onUrlChanged updateUrl\r\n        router.children [\r\n          match currentUrl with\r\n          | [] -> Components.Home()\r\n          | [ \"elmish-converter\" ] -> ElmishConverter.TemperatureConverter()\r\n          | [ \"converter\" ] -> Converter.Converter()\r\n          | otherwise -> Html.h1 \"Not found\"\r\n        ]\r\n      ]\r\n```\r\n\r\n![Converters](https://rasheedaboudblogstorage.blob.core.windows.net/blogs/converters.gif?sp=r&st=2024-01-05T19:36:21Z&se=2050-01-06T03:36:21Z&spr=https&sv=2022-11-02&sr=b&sig=sn18ulpkLtaS9fd5RYdv%2B8jC0gN3KuwN1QMLDzaAPck%3D)\r\n\r\nRun the app with ```pnpm start``` and navigate to ```/#elmish-converter``` and ```/#converter``` respectively. You should see two identical pages.\r\n\r\nIn the final solution I will save both these approaches in separate files so you will have examples of both side by side.\r\n\r\n### Update **2024-1-7**\r\n\r\nA colleague of mine was kind enough that I forgot an important concept regarding state management in react,  ``useContext``!! For those of you not familiar with this react hook, it allows you to pass state from a parent component to a child and avoids prop drilling (ie: passing state down from component to component.)\r\n\r\nFeliz has a mechanism to use this hook in your apps. I've updated the repository to include a an example.\r\n\r\nIn a file called `AppContext.fs`:\r\n\r\n```fsharp\r\n[\u003cRequireQualifiedAccess>]\r\nmodule AppContext\r\n\r\nopen Feliz\r\n\r\ntype AppState = { message: string }\r\n\r\nlet appState = { message = \"Hello\" }\r\n\r\nlet appContext = React.createContext ()\r\n\r\n[\u003cReactComponent>]\r\nlet MessageContext (child: ReactElement) =\r\n  let (state, setState) = React.useState (appState)\r\n  React.contextProvider (appContext, (state, setState), React.fragment [ child ])\r\n```\r\n\r\nUpdate the `Home` and `Router` component with the following:\r\n\r\n```fsharp\r\n  [\u003cReactComponent>]\r\n  static member Home() =\r\n    let (context, setState) = React.useContext (AppContext.appContext)\r\n\r\n    let logState () = console.log (context.message)\r\n\r\n    React.useEffect (logState, [| box context |])\r\n    React.useEffect ((fun () -> setState ({ message = \"Another Message\" })), [||])\r\n\r\n\r\n    Html.div [\r\n      prop.className \"container mx-auto\"\r\n      prop.children [\r\n        Html.h1 (sprintf \"Home Page - %s\" context.message)\r\n        Daisy.button.button [\r\n          prop.text \"Click Me!!\"\r\n          prop.onClick (fun _ -> setState ({ message = \"This is a message from the context\" }))\r\n        ]\r\n      ]\r\n    ]\r\n```\r\n\r\n```fsharp\r\n  [\u003cReactComponent>]\r\n  static member Router() =\r\n    let (currentUrl, updateUrl) = React.useState (Router.currentUrl ())\r\n\r\n    AppContext.MessageContext(\r\n      Html.div [\r\n        Components.NavBar()\r\n        React.router [\r\n          router.onUrlChanged updateUrl\r\n          router.children [\r\n            match currentUrl with\r\n            | [] -> Components.Home()\r\n            | [ \"elmish-converter\" ] -> ElmishConverter.TemperatureConverter()\r\n            | [ \"converter\" ] -> Converter.Converter()\r\n            | otherwise -> Html.h1 \"Not found\"\r\n          ]\r\n        ]\r\n      ]\r\n    )\r\n```\r\n\r\nWe create a react context with the `type AppState = { message: string }` state. We then wrap the router component in the context provider. This makes our app state globally available. \r\n\r\n`React.contextProvider` has following signature `IContext\u003c'a> *  'a * ReactElement -> ReactElement`. It takes a context some state and an element, which in our case is just a fragment. We are passing in `(state,setState)` as the generic `'a` as means to access and change the value from any child element. You could just as easily wire this up to work with an elmish architecture.   \r\n\r\nIn the Home component we request the current `AppState` and are given the state as well as a function to update it. We also added a button in the home component to update the `AppState` dynamically.\r\n\r\n[Compositional IT](https://www.compositional-it.com/news-blog/component-communication-using-react-context/) and [Feliz](https://zaid-ajaj.github.io/Feliz/#/Feliz/React/ContextPropagation) both give wonderful examples of how to use the `useContext` hook. \r\n\r\n### Conclusion\r\n\r\nThroughout this series, we started with getting set up with Feliz and Fable, added environment variables, and constructed UI elements using Feliz.DaisyUI. With the addition of state management using `useElmish` and `useState`, we've laid a solid foundation for building powerful and complex web applications with F#. Remember that the magic of F# isn't just its succinctness; it's the robust functional programming paradigm it supports that enables us to build reliable applications.\r\n\r\nAs you can see both methods are , however I find anytime I'm building stateful components I prefer the elmish style. I find it easier to read and reason about. If however im just rendering out a bit of state I will use the `useState` hook. I also like that you can easily see all the possible state transitions in your update function, and that the F# compiler will help you if you add a new message type and forget to handle it.\r\n\r\nIf you want to see any specific topics covered in the future please open a github issue and up-vote it. Otherwise I'll just keep on building up our app to show off all the capabilities that F# has to offer.\r\n\r\nHappy coding, and stay tuned for the next part of our series, where we'll dive deeper into Feliz/Fable by exploring how make api calls!\r\n"}},"urlPathname":"/blog/part-4-state-management-in-feliz","routeParams":{"pageTitle":"part-4-state-management-in-feliz"},"documentProps":{"title":"Part 4-State Management in Feliz","description":"In the post, two methods of state management in Feliz are demonstrated for an F# web application: the `useElmish` hook for Elmish-style state management and the `useState` hook for simpler state updates. A temperature converter example is used to illustrate both approaches, which are then integrated into a router."},"abortReason":"!undefined","_urlRewrite":null,"_urlRedirect":"!undefined","abortStatusCode":"!undefined","_abortCall":"!undefined","_pageContextInitIsPassedToClient":"!undefined","_pageId":"/pages/blog/@pageTitle","data":"!undefined"}</script>
        <script src="/assets/entries/entry-server-routing.saybZ-Sm.js" type="module" async></script>
        <link rel="modulepreload" href="/assets/entries/pages_blog_-pageTitle.enSvSaOM.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/assets/chunks/chunk-GZFZyJJ5.js" as="script" type="text/javascript">
      </body>
    </html>